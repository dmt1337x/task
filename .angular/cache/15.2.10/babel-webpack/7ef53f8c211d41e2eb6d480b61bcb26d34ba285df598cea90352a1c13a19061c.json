{"ast":null,"code":"import { BehaviorSubject, combineLatestWith } from 'rxjs';\nimport { GET_ALL_USERS_QUERY_PORT } from '../../../../application/ports/primary/query/get-all-users.query-port';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { FormControl, FormGroup, ReactiveFormsModule } from '@angular/forms';\nimport { map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nfunction UsersListComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"div\", 7);\n    i0.ɵɵelement(2, \"img\", 8);\n    i0.ɵɵelementStart(3, \"div\", 9)(4, \"h5\", 10);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 11);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"button\", 12);\n    i0.ɵɵtext(9, \"Details\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const user_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", user_r1.avatar, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(user_r1.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r1.username);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", \"/users/\" + user_r1.id);\n  }\n}\nexport class UsersListComponent {\n  constructor(_getAllUsersQueryPort) {\n    this._getAllUsersQueryPort = _getAllUsersQueryPort;\n    this.searchForm = new FormGroup({\n      search: new FormControl()\n    });\n    this._searchSubject = new BehaviorSubject('');\n    this.search$ = this._searchSubject.asObservable();\n    this.users$ = this._getAllUsersQueryPort.getAllUsers().pipe(combineLatestWith(this.search$), map(([users, search]) => search ? users.filter(user => user.username.toLowerCase() === search.toLowerCase()) : users));\n    this.searchForm.get('search')?.valueChanges.pipe(map(search => this._searchSubject.next(search))).subscribe();\n    this.search$.subscribe(x => console.log(x));\n  }\n  static #_ = this.ɵfac = function UsersListComponent_Factory(t) {\n    return new (t || UsersListComponent)(i0.ɵɵdirectiveInject(GET_ALL_USERS_QUERY_PORT));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UsersListComponent,\n    selectors: [[\"lib-users-list\"]],\n    standalone: true,\n    features: [i0.ɵɵStandaloneFeature],\n    decls: 7,\n    vars: 4,\n    consts: [[3, \"formGroup\", \"ngSubmit\"], [\"type\", \"text\", \"formControlName\", \"search\", \"placeholder\", \"Search\"], [\"type\", \"submit\", \"value\", \"Submit\"], [1, \"container\", \"mt-5\"], [1, \"row\"], [\"class\", \"col-4\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-4\"], [1, \"card\", \"mb-3\"], [\"alt\", \"Avatar\", 1, \"card-img-top\", 3, \"src\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [1, \"btn\", \"btn-primary\", 3, \"routerLink\"]],\n    template: function UsersListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function UsersListComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.onSearchFormSubmitted(ctx.searchForm);\n        });\n        i0.ɵɵelement(1, \"input\", 1)(2, \"input\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4);\n        i0.ɵɵtemplate(5, UsersListComponent_div_5_Template, 10, 4, \"div\", 5);\n        i0.ɵɵpipe(6, \"async\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.searchForm);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(6, 2, ctx.users$));\n      }\n    },\n    dependencies: [CommonModule, i1.NgForOf, i1.AsyncPipe, RouterModule, i2.RouterLink, ReactiveFormsModule, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName],\n    styles: [\".mat-button-hovered[_ngcontent-%COMP%]:hover {\\n  background-color: #1976D2;\\n  color: #fff;\\n}\\n\\n.user-avatar[_ngcontent-%COMP%] {\\n  height: 100px;\\n  width: 100px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL3VzZXItYWxidW1zL3NyYy9saWIvYWRhcHRlcnMvcHJpbWFyeS9jb21wb25lbnRzL3VzZXJzLWxpc3QvdXNlcnMtbGlzdC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHlCQUFBO0VBQ0EsV0FBQTtBQUNGOztBQUVBO0VBQ0UsYUFBQTtFQUNBLFlBQUE7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIi5tYXQtYnV0dG9uLWhvdmVyZWQ6aG92ZXIge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICMxOTc2RDI7XHJcbiAgY29sb3I6ICNmZmY7XHJcbn1cclxuXHJcbi51c2VyLWF2YXRhciB7XHJcbiAgaGVpZ2h0OiAxMDBweDtcclxuICB3aWR0aDogMTAwcHg7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"],\n    changeDetection: 0\n  });\n}","map":{"version":3,"mappings":"AACA,SACEA,eAAe,EACfC,iBAAiB,QAKZ,MAAM;AAEb,SACEC,wBAAwB,QAEnB,sEAAsE;AAC7E,SAASC,YAAY,QAAQ,iBAAiB;AAC9C,SAASC,YAAY,QAAQ,iBAAiB;AAC9C,SAASC,WAAW,EAAEC,SAAS,EAAEC,mBAAmB,QAAQ,gBAAgB;AAC5E,SAASC,GAAG,QAAQ,gBAAgB;;;;;;;ICRhCC,8BAAuD;IAEnDA,yBAA2D;IAC3DA,8BAAuB;IACEA,YAAe;IAAAA,iBAAK;IAC3CA,6BAAqB;IAAAA,YAAmB;IAAAA,iBAAI;IAC5CA,kCAAmE;IAAAA,uBAAO;IAAAA,iBAAS;;;;IAJhFA,eAAmB;IAAnBA,sDAAmB;IAECA,eAAe;IAAfA,kCAAe;IACjBA,eAAmB;IAAnBA,sCAAmB;IAChCA,eAAkC;IAAlCA,mDAAkC;;;ADYpD,OAAM,MAAOC,kBAAkB;EAsB7BC,YAEUC,qBAA2C;IAA3C,0BAAqB,GAArBA,qBAAqB;IAvBtB,eAAU,GAAc,IAAIN,SAAS,CAAC;MAAEO,MAAM,EAAE,IAAIR,WAAW;IAAE,CAAE,CAAC;IAErE,mBAAc,GAA4B,IAAIL,eAAe,CACnE,EAAE,CACH;IAEM,YAAO,GAAuB,IAAI,CAACc,cAAc,CAACC,YAAY,EAAE;IAE9D,WAAM,GAA4B,IAAI,CAACH,qBAAqB,CAClEI,WAAW,EAAE,CACbC,IAAI,CACHhB,iBAAiB,CAAC,IAAI,CAACiB,OAAO,CAAC,EAC/BV,GAAG,CAAC,CAAC,CAACW,KAAK,EAAEN,MAAM,CAAC,KAClBA,MAAM,GACFM,KAAK,CAACC,MAAM,CACTC,IAAI,IAAKA,IAAI,CAACC,QAAQ,CAACC,WAAW,EAAE,KAAKV,MAAM,CAACU,WAAW,EAAE,CAC/D,GACDJ,KAAK,CACV,CACF;IAMD,IAAI,CAACK,UAAU,CACZC,GAAG,CAAC,QAAQ,CAAC,EACZC,YAAY,CAACT,IAAI,CAACT,GAAG,CAAEK,MAAM,IAAK,IAAI,CAACC,cAAc,CAACa,IAAI,CAACd,MAAM,CAAC,CAAC,CAAC,CACrEe,SAAS,EAAE;IAEd,IAAI,CAACV,OAAO,CAACU,SAAS,CAAEC,CAAC,IAAKC,OAAO,CAACC,GAAG,CAACF,CAAC,CAAC,CAAC;EAC/C;EAAC;qBAhCUnB,kBAAkB,uBAuBnBR,wBAAwB;EAAA;EAAA;UAvBvBQ,kBAAkB;IAAAsB;IAAAC;IAAAC;IAAAC;IAAAC;IAAAC;IAAAC;MAAA;QC3B/B7B,+BAA8E;QAA/CA;UAAA,OAAY8B,yCAAiC;QAAA,EAAC;QAC3E9B,2BAAkE;QAIpEA,iBAAO;QAEPA,8BAA4B;QAExBA,oEASM;;QACRA,iBAAM;;;QAnBFA,0CAAwB;QASUA,eAAiB;QAAjBA,0DAAiB;;;mBDgB7CN,YAAY,4BAAEC,YAAY,iBAAEG,mBAAmB;IAAAiC;IAAAC;EAAA","names":["BehaviorSubject","combineLatestWith","GET_ALL_USERS_QUERY_PORT","CommonModule","RouterModule","FormControl","FormGroup","ReactiveFormsModule","map","i0","UsersListComponent","constructor","_getAllUsersQueryPort","search","_searchSubject","asObservable","getAllUsers","pipe","search$","users","filter","user","username","toLowerCase","searchForm","get","valueChanges","next","subscribe","x","console","log","selectors","standalone","features","decls","vars","consts","template","ctx","styles","changeDetection"],"sourceRoot":"","sources":["E:\\WORK\\task\\projects\\user-albums\\src\\lib\\adapters\\primary\\components\\users-list\\users-list.component.ts","E:\\WORK\\task\\projects\\user-albums\\src\\lib\\adapters\\primary\\components\\users-list\\users-list.component.html"],"sourcesContent":["import { ChangeDetectionStrategy, Component, Inject } from '@angular/core';\nimport {\n  BehaviorSubject,\n  combineLatestWith,\n  filter,\n  Observable,\n  switchAll,\n  switchMap,\n} from 'rxjs';\nimport { UserQuery } from '../../../../application/ports/primary/query/user.query';\nimport {\n  GET_ALL_USERS_QUERY_PORT,\n  GetAllUsersQueryPort,\n} from '../../../../application/ports/primary/query/get-all-users.query-port';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { FormControl, FormGroup, ReactiveFormsModule } from '@angular/forms';\nimport { map } from 'rxjs/operators';\n\n@Component({\n  selector: 'lib-users-list',\n  styleUrls: ['./users-list.component.scss'],\n  templateUrl: './users-list.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [CommonModule, RouterModule, ReactiveFormsModule],\n})\nexport class UsersListComponent {\n  readonly searchForm: FormGroup = new FormGroup({ search: new FormControl() });\n\n  private _searchSubject: BehaviorSubject<string> = new BehaviorSubject<string>(\n    ''\n  );\n\n  public search$: Observable<string> = this._searchSubject.asObservable();\n\n  readonly users$: Observable<UserQuery[]> = this._getAllUsersQueryPort\n    .getAllUsers()\n    .pipe(\n      combineLatestWith(this.search$),\n      map(([users, search]) =>\n        search\n          ? users.filter(\n              (user) => user.username.toLowerCase() === search.toLowerCase()\n            )\n          : users\n      )\n    );\n\n  constructor(\n    @Inject(GET_ALL_USERS_QUERY_PORT)\n    private _getAllUsersQueryPort: GetAllUsersQueryPort\n  ) {\n    this.searchForm\n      .get('search')\n      ?.valueChanges.pipe(map((search) => this._searchSubject.next(search)))\n      .subscribe();\n\n    this.search$.subscribe((x) => console.log(x));\n  }\n}\n","<form [formGroup]=\"searchForm\" (ngSubmit)=\"onSearchFormSubmitted(searchForm)\">\n  <input type=\"text\" formControlName=\"search\" placeholder=\"Search\"/><input\n  type=\"submit\"\n  value=\"Submit\"\n/>\n</form>\n\n<div class=\"container mt-5\">\n  <div class=\"row\">\n    <div class=\"col-4\" *ngFor=\"let user of users$ | async\">\n      <div class=\"card mb-3\">\n        <img [src]=\"user.avatar\" alt=\"Avatar\" class=\"card-img-top\">\n        <div class=\"card-body\">\n          <h5 class=\"card-title\">{{ user.name }}</h5>\n          <p class=\"card-text\">{{ user.username }}</p>\n          <button [routerLink]=\"'/users/' + user.id\" class=\"btn btn-primary\">Details</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}