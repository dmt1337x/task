{"ast":null,"code":"import { map, switchMap } from 'rxjs/operators';\nimport { GET_ALL_USERS_DTO_PORT } from '../ports/secondary/dto/get-all-users.dto-port';\nimport { GET_ONE_USER_DTO_PORT } from '../ports/secondary/dto/get-one-user.dto-port';\nimport { PATCH_USER_CONTEXT_PORT } from '../ports/secondary/context/patch-user.context-port';\nimport { SELECT_USER_CONTEXT_PORT } from '../ports/secondary/context/select-user.context-port';\nimport { UserQuery } from '../ports/primary/query/user.query';\nimport * as i0 from \"@angular/core\";\nexport class UserAlbumsState {\n  constructor(_getAllUsersDtoPort, _getOneUserDtoPort, _patchUserContextPort, _selectUserContextPort) {\n    this._getAllUsersDtoPort = _getAllUsersDtoPort;\n    this._getOneUserDtoPort = _getOneUserDtoPort;\n    this._patchUserContextPort = _patchUserContextPort;\n    this._selectUserContextPort = _selectUserContextPort;\n  }\n  getAllUsers() {\n    return this._getAllUsersDtoPort.getAllUsers().pipe(map(allUsers => allUsers.map(user => this.mapToUserQuery(user))));\n  }\n  getUserDetails(id) {\n    return this._getOneUserDtoPort.getOneUser(id).pipe(\n    // map((user: UserDTO) => this.mapToUserQuery(user))\n    switchMap(user => this._patchUserContextPort.patch(user)));\n  }\n  test(id) {\n    return this._getOneUserDtoPort.getOneUser(id).pipe(\n    // map((user: UserDTO) => this.mapToUserQuery(user))\n    switchMap(user => this._patchUserContextPort.patch(user)));\n  }\n  mapToUserQuery(user) {\n    return new UserQuery(user.id, this.getAvatar(), user.name, user.username, user.email, this.getAddress(user), user.phone, user.website, user.company.name);\n  }\n  getAddress(user) {\n    return `${user.address.street},${user.address.zipcode},${user.address.city},`;\n  }\n  getAvatar() {\n    return 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Angular_full_color_logo.svg/512px-Angular_full_color_logo.svg.png';\n  }\n  initDetails() {}\n  static #_ = this.ɵfac = function UserAlbumsState_Factory(t) {\n    return new (t || UserAlbumsState)(i0.ɵɵinject(GET_ALL_USERS_DTO_PORT), i0.ɵɵinject(GET_ONE_USER_DTO_PORT), i0.ɵɵinject(PATCH_USER_CONTEXT_PORT), i0.ɵɵinject(SELECT_USER_CONTEXT_PORT));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: UserAlbumsState,\n    factory: UserAlbumsState.ɵfac\n  });\n}","map":{"version":3,"mappings":"AAEA,SAASA,GAAG,EAAEC,SAAS,QAAQ,gBAAgB;AAI/C,SAASC,sBAAsB,QAA4B,+CAA+C;AAC1G,SAASC,qBAAqB,QAA2B,8CAA8C;AACvG,SAASC,uBAAuB,QAA8B,oDAAoD;AAClH,SAASC,wBAAwB,QAA+B,qDAAqD;AACrH,SAASC,SAAS,QAAQ,mCAAmC;;AAI7D,OAAM,MAAOC,eAAe;EAE1BC,YAEUC,mBAAuC,EAEvCC,kBAAqC,EAErCC,qBAA2C,EAE3CC,sBAA6C;IAN7C,wBAAmB,GAAnBH,mBAAmB;IAEnB,uBAAkB,GAAlBC,kBAAkB;IAElB,0BAAqB,GAArBC,qBAAqB;IAErB,2BAAsB,GAAtBC,sBAAsB;EAC5B;EAEJC,WAAW;IACT,OAAO,IAAI,CAACJ,mBAAmB,CAC5BI,WAAW,EAAE,CACbC,IAAI,CACHd,GAAG,CAAEe,QAAmB,IACtBA,QAAQ,CAACf,GAAG,CAAEgB,IAAI,IAAK,IAAI,CAACC,cAAc,CAACD,IAAI,CAAC,CAAC,CAClD,CACF;EACL;EAEAE,cAAc,CAACC,EAAU;IACvB,OAAO,IAAI,CAACT,kBAAkB,CAACU,UAAU,CAACD,EAAE,CAAC,CAACL,IAAI;IAChD;IACAb,SAAS,CAAEe,IAAa,IAAK,IAAI,CAACL,qBAAqB,CAACU,KAAK,CAACL,IAAI,CAAC,CAAC,CACrE;EACH;EAEAM,IAAI,CAACH,EAAU;IACb,OAAO,IAAI,CAACT,kBAAkB,CAACU,UAAU,CAACD,EAAE,CAAC,CAACL,IAAI;IAChD;IACAb,SAAS,CAAEe,IAAa,IAAK,IAAI,CAACL,qBAAqB,CAACU,KAAK,CAACL,IAAI,CAAC,CAAC,CACrE;EACH;EAEQC,cAAc,CAACD,IAAa;IAClC,OAAO,IAAIV,SAAS,CAClBU,IAAI,CAACG,EAAE,EACP,IAAI,CAACI,SAAS,EAAE,EAChBP,IAAI,CAACQ,IAAI,EACTR,IAAI,CAACS,QAAQ,EACbT,IAAI,CAACU,KAAK,EACV,IAAI,CAACC,UAAU,CAACX,IAAI,CAAC,EACrBA,IAAI,CAACY,KAAK,EACVZ,IAAI,CAACa,OAAO,EACZb,IAAI,CAACc,OAAO,CAACN,IAAI,CAClB;EACH;EAEQG,UAAU,CAACX,IAAa;IAC9B,OAAO,GAAGA,IAAI,CAACe,OAAO,CAACC,MAAM,IAAIhB,IAAI,CAACe,OAAO,CAACE,OAAO,IAAIjB,IAAI,CAACe,OAAO,CAACG,IAAI,GAAG;EAC/E;EAEQX,SAAS;IACf,OAAO,6HAA6H;EACtI;EAEAY,WAAW,IACX;EAAC;qBA5DU5B,eAAe,cAGhBL,sBAAsB,eAEtBC,qBAAqB,eAErBC,uBAAuB,eAEvBC,wBAAwB;EAAA;EAAA;WATvBE,eAAe;IAAA6B,SAAf7B,eAAe;EAAA","names":["map","switchMap","GET_ALL_USERS_DTO_PORT","GET_ONE_USER_DTO_PORT","PATCH_USER_CONTEXT_PORT","SELECT_USER_CONTEXT_PORT","UserQuery","UserAlbumsState","constructor","_getAllUsersDtoPort","_getOneUserDtoPort","_patchUserContextPort","_selectUserContextPort","getAllUsers","pipe","allUsers","user","mapToUserQuery","getUserDetails","id","getOneUser","patch","test","getAvatar","name","username","email","getAddress","phone","website","company","address","street","zipcode","city","initDetails","factory"],"sourceRoot":"","sources":["E:\\WORK\\task\\projects\\user-albums\\src\\lib\\application\\state\\user-albums.state.ts"],"sourcesContent":["import { Inject, Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { GetAllUsersQueryPort } from '../ports/primary/query/get-all-users.query-port';\nimport { GetUserDetailsQueryPort } from '../ports/primary/query/get-user-details.query-port';\nimport { InitDetailsCommandPort } from '../ports/primary/command/init-details.command-port';\nimport { GET_ALL_USERS_DTO_PORT, GetAllUsersDtoPort } from '../ports/secondary/dto/get-all-users.dto-port';\nimport { GET_ONE_USER_DTO_PORT, GetOneUserDtoPort } from '../ports/secondary/dto/get-one-user.dto-port';\nimport { PATCH_USER_CONTEXT_PORT, PatchUserContextPort } from '../ports/secondary/context/patch-user.context-port';\nimport { SELECT_USER_CONTEXT_PORT, SelectUserContextPort } from '../ports/secondary/context/select-user.context-port';\nimport { UserQuery } from '../ports/primary/query/user.query';\nimport { UserDTO } from '../ports/secondary/dto/user.dto';\n\n@Injectable()\nexport class UserAlbumsState\n  implements GetAllUsersQueryPort, GetUserDetailsQueryPort, InitDetailsCommandPort {\n  constructor(\n    @Inject(GET_ALL_USERS_DTO_PORT)\n    private _getAllUsersDtoPort: GetAllUsersDtoPort,\n    @Inject(GET_ONE_USER_DTO_PORT)\n    private _getOneUserDtoPort: GetOneUserDtoPort,\n    @Inject(PATCH_USER_CONTEXT_PORT)\n    private _patchUserContextPort: PatchUserContextPort,\n    @Inject(SELECT_USER_CONTEXT_PORT)\n    private _selectUserContextPort: SelectUserContextPort\n  ) { }\n\n  getAllUsers(): Observable<UserQuery[]> {\n    return this._getAllUsersDtoPort\n      .getAllUsers()\n      .pipe(\n        map((allUsers: UserDTO[]) =>\n          allUsers.map((user) => this.mapToUserQuery(user))\n        )\n      );\n  }\n\n  getUserDetails(id: number): Observable<UserQuery> {\n    return this._getOneUserDtoPort.getOneUser(id).pipe(\n      // map((user: UserDTO) => this.mapToUserQuery(user))\n      switchMap((user: UserDTO) => this._patchUserContextPort.patch(user))\n    );\n  }\n\n  test(id: number): Observable<void> {\n    return this._getOneUserDtoPort.getOneUser(id).pipe(\n      // map((user: UserDTO) => this.mapToUserQuery(user))\n      switchMap((user: UserDTO) => this._patchUserContextPort.patch(user))\n    );\n  }\n\n  private mapToUserQuery(user: UserDTO) {\n    return new UserQuery(\n      user.id,\n      this.getAvatar(),\n      user.name,\n      user.username,\n      user.email,\n      this.getAddress(user),\n      user.phone,\n      user.website,\n      user.company.name\n    );\n  }\n\n  private getAddress(user: UserDTO) {\n    return `${user.address.street},${user.address.zipcode},${user.address.city},`;\n  }\n\n  private getAvatar() {\n    return 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Angular_full_color_logo.svg/512px-Angular_full_color_logo.svg.png';\n  }\n\n  initDetails(): Observable<void> {\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}