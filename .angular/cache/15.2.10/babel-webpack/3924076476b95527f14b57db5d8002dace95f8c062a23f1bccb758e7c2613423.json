{"ast":null,"code":"import * as i0 from \"@angular/core\";\nexport class UserAlbumsState {\n  static #_ = this.ɵfac = function UserAlbumsState_Factory(t) {\n    return new (t || UserAlbumsState)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: UserAlbumsState,\n    factory: UserAlbumsState.ɵfac\n  });\n}","map":{"version":3,"mappings":";AAmCA,OAAM,MAAOA,eAAe;EAAA;qBAAfA,eAAe;EAAA;EAAA;WAAfA,eAAe;IAAAC,SAAfD,eAAe;EAAA","names":["UserAlbumsState","factory"],"sourceRoot":"","sources":["E:\\WORK\\task\\projects\\user-albums\\src\\lib\\application\\state\\user-albums.state.ts"],"sourcesContent":["import { Inject, Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { GetAllUsersQueryPort } from '../ports/primary/query/get-all-users.query-port';\nimport { GetUserDetailsQueryPort } from '../ports/primary/query/get-user-details.query-port';\nimport { InitDetailsCommandPort } from '../ports/primary/command/init-details.command-port';\nimport { InitPhotosCommandPort } from '../ports/primary/command/init-photos.command-port';\nimport {\n  GET_ALL_USERS_DTO_PORT,\n  GetAllUsersDtoPort,\n} from '../ports/secondary/dto/get-all-users.dto-port';\nimport {\n  GET_ONE_USER_DTO_PORT,\n  GetOneUserDtoPort,\n} from '../ports/secondary/dto/get-one-user.dto-port';\nimport {\n  PATCH_USER_CONTEXT_PORT,\n  PatchUserContextPort,\n} from '../ports/secondary/context/patch-user.context-port';\nimport {\n  SELECT_USER_CONTEXT_PORT,\n  SelectUserContextPort,\n} from '../ports/secondary/context/select-user.context-port';\nimport {\n  GET_ALL_PHOTOS_DTO_PORT,\n  GetAllPhotosDtoPort,\n} from '../ports/secondary/dto/get-all-photos.dto-port';\nimport {\n  GET_ONE_PHOTO_DTO_PORT,\n  GetOnePhotoDtoPort,\n} from '../ports/secondary/dto/get-one-photo.dto-port';\nimport { UserQuery } from '../ports/primary/query/user.query';\nimport { UserDTO } from '../ports/secondary/dto/user.dto';\n\n@Injectable()\nexport class UserAlbumsState\n  implements\n    GetAllUsersQueryPort,\n    GetUserDetailsQueryPort,\n    InitDetailsCommandPort,\n    \n{\n  constructor(\n    @Inject(GET_ALL_USERS_DTO_PORT)\n    private _getAllUsersDtoPort: GetAllUsersDtoPort,\n    @Inject(GET_ONE_USER_DTO_PORT)\n    private _getOneUserDtoPort: GetOneUserDtoPort,\n    @Inject(PATCH_USER_CONTEXT_PORT)\n    private _patchUserContextPort: PatchUserContextPort,\n    @Inject(SELECT_USER_CONTEXT_PORT)\n    private _selectUserContextPort: SelectUserContextPort,\n    @Inject(GET_ONE_PHOTO_DTO_PORT)\n    private _getOnePhotoDtoPort: GetOnePhotoDtoPort\n  ) {}\n\n  getAllUsers(): Observable<UserQuery[]> {\n    return this._getAllUsersDtoPort\n      .getAllUsers()\n      .pipe(\n        map((allUsers: UserDTO[]) =>\n          allUsers.map((user) => this.mapToUserQuery(user))\n        )\n      );\n  }\n\n  getUserDetails(): Observable<UserQuery> {\n    return this._selectUserContextPort.select$.pipe(\n      map((user: UserDTO) => this.mapToUserQuery(user))\n    );\n  }\n\n  initDetails(id: number): Observable<void> {\n    return this._getOneUserDtoPort\n      .getOneUser(id)\n      .pipe(\n        switchMap((user: UserDTO) => this._patchUserContextPort.patch(user))\n      );\n  }\n\n  private mapToUserQuery(user: UserDTO) {\n    return new UserQuery(\n      user.id,\n      this.getAvatar(),\n      user.name,\n      user.username,\n      user.email,\n      this.getAddress(user),\n      user.phone,\n      user.website,\n      user.company.name\n    );\n  }\n\n  private getAddress(user: UserDTO) {\n    return `${user.address.street},${user.address.zipcode},${user.address.city},`;\n  }\n\n  private getAvatar() {\n    return 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Angular_full_color_logo.svg/512px-Angular_full_color_logo.svg.png';\n  }\n\n  initPhotos(id: number): Observable<void> {\n    return this._getOnePhotoDtoPort.getOnePhoto(id);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}